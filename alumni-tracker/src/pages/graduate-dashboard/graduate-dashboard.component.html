<!-- graduate-dashboard.component.html -->
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
  rel="stylesheet"
/>
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
  rel="stylesheet"
/>

<style>
  body {
    background-color: #f2f6fc;
  }

  .card-rounded {
    border-radius: 1rem;
  }

  .section-title {
    font-weight: 600;
    color: #2c3e50;
  }

  .table th,
  .table td {
    vertical-align: middle;
  }

  .bg-soft {
    background-color: #ffffff;
    border-radius: 1rem;
    padding: 1.5rem;
    box-shadow: 0 0.25rem 1rem rgba(0, 0, 0, 0.05);
  }
</style>

<div class="container py-5">
  <div class="text-center mb-5">
    <h1 class="fw-bold text-primary display-5 mb-1">ğŸ“ ÎŸÎ¹ Î‘Ï€ÏŒÏ†Î¿Î¹Ï„Î¿Î¯ ÎœÎ¿Ï…</h1>
    <p class="text-muted">Î”Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„ÎµÎ¯Ï„Îµ Ï„Î¿Ï…Ï‚ Î±Ï€ÏŒÏ†Î¿Î¹Ï„Î¿Ï…Ï‚ ÎºÎ±Î¹ Ï„Î¹Ï‚ Î¸Î­ÏƒÎµÎ¹Ï‚ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚ Ï„Î¿Ï…Ï‚</p>
  </div>

  <div class="bg-soft mb-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h5 class="section-title m-0">
        <i class="bi bi-funnel"></i> Î¦Î¯Î»Ï„ÏÎ± Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚
      </h5>
      <div>
        <button class="btn btn-success me-2" (click)="openModal()">
          <i class="bi bi-plus-lg"></i> ÎÎ­Î¿Ï‚ Î‘Ï€ÏŒÏ†Î¿Î¹Ï„Î¿Ï‚
        </button>
        <button class="btn btn-sm btn-outline-primary" (click)="applyFilters()">
          <i class="bi bi-search"></i> Î•Ï†Î±ÏÎ¼Î¿Î³Î®
        </button>
      </div>
    </div>

    <div class="row g-3">
      <div class="col-md-4 col-lg-3">
        <input type="text" class="form-control" placeholder="ÎŒÎ½Î¿Î¼Î±" [(ngModel)]="firstName" />
      </div>
      <div class="col-md-4 col-lg-3">
        <input type="text" class="form-control" placeholder="Î•Ï€ÏÎ½Ï…Î¼Î¿" [(ngModel)]="lastName" />
      </div>
      <div class="col-md-4 col-lg-3">
        <input type="email" class="form-control" placeholder="Email" [(ngModel)]="email" />
      </div>
      <div class="col-md-6 col-lg-3">
        <input type="number" class="form-control" placeholder="ÎˆÏ„Î¿Ï‚ Î±Ï€Î¿Ï†Î¿Î¯Ï„Î·ÏƒÎ·Ï‚" [(ngModel)]="graduationYear" />
      </div>
      <div class="col-md-6 col-lg-3">
        <input type="number" class="form-control" placeholder="Î’Î±Î¸Î¼ÏŒÏ‚" [(ngModel)]="degreeGrade" />
      </div>
    </div>
  </div>

  <div class="bg-soft mb-4">
    <h5 class="section-title mb-3">
      <i class="bi bi-people"></i> Î›Î¯ÏƒÏ„Î± Î‘Ï€Î¿Ï†Î¿Î¯Ï„Ï‰Î½
       <span class="badge bg-primary fs-6">{{ totalGraduates }}</span>
    </h5>
   
    <div class="table-responsive">
      <table class="table table-hover align-middle">
        <thead class="table-primary text-center">
          <tr>
            <th>ÎŒÎ½Î¿Î¼Î±</th>
            <th>Email</th>
            <th>Î‘Ï€Î¿Ï†Î¿Î¯Ï„Î·ÏƒÎ·</th>
            <th>Î’Î±Î¸Î¼ÏŒÏ‚</th>
            <th>Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚</th>
          </tr>
        </thead>
        <tbody *ngIf="graduates.length > 0; else noGrads">
          <tr *ngFor="let grad of graduates" [class.fw-bold]="grad.userId === currentUserId">
            <td>{{ grad.firstName }} {{ grad.lastName }}</td>
            <td>{{ grad.email }}</td>
            <td>{{ grad.graduationDate | date }}</td>
            <td>{{ grad.degreeGrade }}</td>
            <td class="text-center">
              <button class="btn btn-sm btn-outline-primary me-2" (click)="editGraduate(grad)">
                <i class="bi bi-pencil"></i>
              </button>
              <button class="btn btn-sm btn-outline-danger" (click)="deleteGraduate(grad.id)">
                <i class="bi bi-trash"></i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <ng-template #noGrads>
      <div class="alert alert-warning text-center mt-4" role="alert">
        Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎ±Î½ Î±Ï€ÏŒÏ†Î¿Î¹Ï„Î¿Î¹ Î³Î¹Î± Ï„Î¿Î½ Ï‡ÏÎ®ÏƒÏ„Î·.
      </div>
    </ng-template>

    <nav *ngIf="totalPages.length > 1" class="mt-3">
      <ul class="pagination justify-content-center">
        <li class="page-item" [class.disabled]="currentPage === 1">
          <button class="page-link" (click)="setPage(currentPage - 1)">
            &laquo;
          </button>
        </li>
        <li class="page-item" *ngFor="let page of totalPages" [class.active]="currentPage === page">
          <button class="page-link" (click)="setPage(page)">
            {{ page }}
          </button>
        </li>
        <li class="page-item" [class.disabled]="currentPage === totalPages.length">
          <button class="page-link" (click)="setPage(currentPage + 1)">
            &raquo;
          </button>
        </li>
      </ul>
    </nav>
  </div>

  <div class="bg-soft">
    <h5 class="section-title mb-3">
      <i class="bi bi-geo-alt-fill"></i> Î§Î¬ÏÏ„Î·Ï‚ Î˜Î­ÏƒÎµÏ‰Î½ Î•ÏÎ³Î±ÏƒÎ¯Î±Ï‚
    </h5>
    <div class="rounded overflow-hidden border" style="min-height: 400px;">
      <app-graduates-map [graduates]="graduates" [currentUserId]="currentUserId"></app-graduates-map>
    </div>
  </div>

  <div class="modal fade show d-block" *ngIf="creatingGraduate" tabindex="-1" role="dialog" style="background: rgba(0, 0, 0, 0.5);">
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î‘Ï€ÏŒÏ†Î¿Î¹Ï„Î¿Ï…</h5>
        <button type="button" class="btn-close" (click)="closeModal()" aria-label="Close"></button>
      </div>
     <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
      <app-new-graduate
        [graduate]="selectedGraduate"
        (submitted)="onGraduateCreated()"
        (cancelled)="closeModal()"
      ></app-new-graduate>
    </div>
    </div>
  </div>
</div>

</div>